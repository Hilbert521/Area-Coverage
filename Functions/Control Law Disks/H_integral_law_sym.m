% MIT License
% 
% Copyright (c) 2016 Sotiris Papatheodorou
% 
% Permission is hereby granted, free of charge, to any person obtaining a copy
% of this software and associated documentation files (the "Software"), to deal
% in the Software without restriction, including without limitation the rights
% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the Software is
% furnished to do so, subject to the following conditions:
% 
% The above copyright notice and this permission notice shall be included in all
% copies or substantial portions of the Software.
% 
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
% SOFTWARE.

function move_vector = H_integral_law_sym( Xi, uradiusi, GVcelli, sradiusi, ...
    Xj, uradiusj, GVcellj, sradiusj )
% Calculate the integral over Hij, Hji and return the move vector

% Symbolic expressions
syms a t xi yi xj yj
assume([a t xi yi xj yj], 'real');
uni_x = sym( '- (((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(yi - yj)^3*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^4*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) - (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) + (a*cosh(t)*(yi - yj)^2)/((xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (sinh(t)*(xi/2 - xj/2)*(yi - yj))/(2*(xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) - 1/2))/(abs((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) - (a*cosh(t)*(2*yi - 2*yj))/(2*(xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (sinh(t)*(yi/2 - yj/2)*(yi - yj))/(2*(xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) - (sinh(t)*(2*yi - 2*yj)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/(2*(xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2))))/(abs((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2)' );
uni_y = sym( '(((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(xi/2 - xj/2))/(2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) + (sinh(t)*(yi - yj)^2*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (a*cosh(t)*(yi - yj))/((xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) - (a*cosh(t)*(yi - yj)^3)/((xi - xj)^4*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2))))/(abs((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(yi/2 - yj/2))/(2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) - (a*cosh(t))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) - (sinh(t)*(2*yi - 2*yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/(2*(xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (a*cosh(t)*(2*yi - 2*yj)*(yi - yj))/(2*(xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + 1/2))/(abs((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2)' );
unj_x = sym( '(((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) - (sinh(t)*(yi - yj)^3*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^4*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (a*cosh(t)*(yi - yj)^2)/((xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) - (sinh(t)*(xi/2 - xj/2)*(yi - yj))/(2*(xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) + 1/2))/(abs((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) + (a*cosh(t)*(2*yi - 2*yj))/(2*(xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + (sinh(t)*(yi/2 - yj/2)*(yi - yj))/(2*(xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) - (sinh(t)*(2*yi - 2*yj)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/(2*(xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2))))/(abs((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2)' );
unj_y = sym( '(((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(xi/2 - xj/2))/(2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) + (sinh(t)*(yi - yj)^2*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) - (a*cosh(t)*(yi - yj))/((xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) + (a*cosh(t)*(yi - yj)^3)/((xi - xj)^4*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2))))/(abs((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((sinh(t)*(yi/2 - yj/2))/(2*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2)) + (a*cosh(t))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)) - (sinh(t)*(2*yi - 2*yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/(2*(xi - xj)^2*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) - (a*cosh(t)*(2*yi - 2*yj)*(yi - yj))/(2*(xi - xj)^3*((yi - yj)^2/(xi - xj)^2 + 1)^(3/2)) + 1/2))/(abs((sinh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((((((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*cosh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) + (((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))*((a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (conj(((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2))*((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2))))/(abs((cosh(t)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (a*sinh(t)*(yi - yj))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2 + abs((a*sinh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) - (cosh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2) - (a*cosh(t))/((yi - yj)^2/(xi - xj)^2 + 1)^(1/2) + (sinh(t)*(yi - yj)*((xi - xj)^2/4 + (yi - yj)^2/4 - a^2)^(1/2))/((xi - xj)*((yi - yj)^2/(xi - xj)^2 + 1)^(1/2)))^2)^(1/2)' );

% Translate and rotate Xi and Xj so that the hyperbola is East-West
XXi = Xi - (Xi+Xj)/2;
XXj = Xj - (Xi+Xj)/2;
theta = -atan2( Xj(2)-Xi(2), Xj(1)-Xi(1) );
XXi = rot(XXi, theta);
XXj = rot(XXj, theta);

% Also translate and rotate both cells
GVi = bsxfun(@minus, GVcelli, (Xi+Xj)/2);
GVj = bsxfun(@minus, GVcellj, (Xi+Xj)/2);
for k=1:length( GVi(1,:) )
    GVi(:,k) = rot( GVi(:,k), theta );
end
for k=1:length( GVj(1,:) )
    GVj(:,k) = rot( GVj(:,k), theta );
end

% Hyperbola parameters
aa = (uradiusi + uradiusj) / 2;
c = norm( Xi-Xj ) / 2;
b = sqrt(c^2 - aa^2);
% Error tolerance
e = 10^-14;

move_vector = zeros(2,1);




% Integral over Hij
% Loop over all vertices of GVi (the rotated and translated cell, as if
% produced by an East-West hyperbola). For each vertex check if it 
% satisfies the East-West hyperbola equation. If it does find t and
% integrate
for k=1:length( GVi(1,:) )
    % Check if it satisfies the hyperbola equation
    if abs(GVi(1,k)^2/aa^2 - GVi(2,k)^2/b^2 - 1) <= e
        % Check if it's inside the sensing circle
        if norm( GVi(:,k)-XXi ) <= sradiusi
            % Find the t parameter
            tt = acosh( GVi(1,k)/a );

            % Substitute the symbolic expressions
            unixc = double( subs(uni_x, [a xi yi xj yj t], [aa XXi(1) XXi(2) XXj(1) XXj(2) tt(k)]) );

            uniyc = double( subs(uni_y, [a xi yi xj yj t], [aa XXi(1) XXi(2) XXj(1) XXj(2) tt(k)]) );

            uni = [( unixc ) ; ( uniyc )];

            % Rotate back to the correct orientation
            uni = rot( uni, -theta );

            % Find the length of the arc (half the distance from each adjacent vertex)
            % Cases for first and last vertices
            if k == 1
                d = norm(GVi(:,k)-GVi(:,end))/2 + ...
                    norm(GVi(:,k)-GVi(:,k+1))/2;
            elseif k == length( GVi(1,:) )
                d = norm(GVi(:,k)-GVi(:,k-1))/2 + ...
                    norm(GVi(:,k)-GVi(:,1))/2;
            else
                d = norm(GVi(:,k)-GVi(:,k-1))/2 + ...
                    norm(GVi(:,k)-GVi(:,k+1))/2;
            end
            % Add to the move vector
            move_vector = move_vector + d*uni;
        end
    end
end




% Integral over Hij
% Loop over all vertices of GVi (the rotated and translated cell, as if
% produced by an East-West hyperbola). For each vertex check if it 
% satisfies the East-West hyperbola equation. If it does find t and
% integrate
for k=1:length( GVj(1,:) )
    % Check if it satisfies the hyperbola equation
    if abs(GVj(1,k)^2/aa^2 - GVj(2,k)^2/b^2 - 1) <= e
        % Check if it's inside the sensing circle
        if norm( GVj(:,k)-XXj ) <= sradiusj
            % Find the t parameter
            tt = acosh( GVj(1,k)/a );

            % Substitute the symbolic expressions
            unjxc = double( subs(unj_x, [a xi yi xj yj t], [aa XXi(1) XXi(2) XXj(1) XXj(2) tt(k)]) );

            unjyc = double( subs(unj_y, [a xi yi xj yj t], [aa XXi(1) XXi(2) XXj(1) XXj(2) tt(k)]) );

            unj = [( unjxc ) ; ( unjyc )];

            % Rotate back to the correct orientation
            unj = rot( unj, -theta );

            % Find the length of the arc (half the distance from each adjacent vertex)
            % Cases for first and last vertices
            if k == 1
                d = norm(GVj(:,k)-GVj(:,end))/2 + ...
                    norm(GVj(:,k)-GVj(:,k+1))/2;
            elseif k == length( GVj(1,:) )
                d = norm(GVj(:,k)-GVj(:,k-1))/2 + ...
                    norm(GVj(:,k)-GVj(:,1))/2;
            else
                d = norm(GVj(:,k)-GVj(:,k-1))/2 + ...
                    norm(GVj(:,k)-GVj(:,k+1))/2;
            end
            % Add to the move vector
            move_vector = move_vector + d*unj;
        end
    end
end

% if isequal(move_vector, zeros(2,1))
%     'zerp'
% end
